<!--
/*
 * Dieses Programm ist freie Software: Sie können es unter den Bedingungen
 * der GNU Affero General Public License, wie von der Free Software Foundation,
 * Version 3 der Lizenz oder (nach Ihrer Wahl) jeder späteren Version,
 * weiterverbreiten und/oder modifizieren.
 *
 * Dieses Programm wird in der Hoffnung verteilt, dass es nützlich sein wird,
 * jedoch OHNE JEDE GEWÄHRLEISTUNG; sogar ohne die implizite Gewährleistung
 * der MARKTFÄHIGKEIT oder EIGNUNG FÜR EINEN BESTIMMTEN ZWECK.
 * Siehe die GNU Affero General Public License für weitere Details.
 *
 * Eine Kopie der GNU Affero General Public License sollten Sie zusammen mit
 * diesem Programm erhalten haben. Falls nicht, siehe <https://www.gnu.org/licenses/>.
 *
 * Copyright (C) 2025 F.G. Schubert & N. Truong
 */
 /*
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <https://www.gnu.org/licenses/>.
 *
 * Copyright (C) 2025 F.G. Schubert & N. Truong
 */
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HZD:CEG</title>
	<link rel="icon" type="image/png" sizes="196x196" href="system/resources/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="system/resources/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="system/resources/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="system/resources/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="system/resources/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="system/resources/favicon-16.png">
	<link rel="apple-touch-icon" href="system/resources/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="system/resources/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="system/resources/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="system/resources/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="system/resources/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="system/resources/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="system/resources/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="system/resources/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="system/resources/favicon-180.png">
    <link rel="stylesheet" href="system/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js" defer></script>
    <script src="system/scriptV2.js" defer></script>
    <script defer>
        function toggleDropdown(btn) {
            // Alle anderen Dropdowns schließen (optional)
            document.querySelectorAll('.dropdown').forEach(d => {
                if (d !== btn.parentElement) d.classList.remove('show');
            });

            // Aktuelles Dropdown ein-/ausblenden
            btn.parentElement.classList.toggle('show');
        }

        // Schließen, wenn außerhalb getippt wird
        window.addEventListener('click', function(e) {
            if (!e.target.matches('.dropbtn')) {
                document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('show'));
            }
        });
    </script>
</head>

<header>
    <img src="system/resources/title2.png">
    <img src="system/resources/title3.png">
</header>

<body>
    <h1 class="title">Encounter Generator</h1>
    <main>
        <h2>Map Settings</h2>
        <div class="firstRow">
            <div class="col1">
                <h3>Choose boxes</h3>
                <div>
                    <div>
                        <input type="checkbox" id="CG" name="CG" value="CG" onclick="update()">
                        <label for="CG"> Core Game</label>
                    </div>
                    <div>
                        <input type="checkbox" id="SL" name="SL" value="SL" onclick="update()">
                        <label for="SL"> Sacred Lands Expansion</label>
                    </div>
                    <div>
                        <input type="checkbox" id="FH" name="FH" value="FH" onclick="update()">
                        <label for="FH"> Forge and Hammer Expansion</label>
                    </div>
                    <div>
                        <input type="checkbox" id="FW" name="FW" value="FW" onclick="update()">
                        <label for="FW"> Frozen Wilds Expansion</label>
                    </div>
                    <div>
                        <input type="checkbox" id="SotS" name="SotS" value="SotS" onclick="update()">
                        <label for="SotS"> Soldiers of the Sun Expansion</label>
                    </div>
                    <div>
                        <input type="checkbox" id="KS" name="KS" value="KS">
                        <label for="KS"> Kickstarter Exclusives (cultists)</label>
                    </div>
                    <p class="explanation">You must select at least one box. Selected boxes are also used for the brief generation.</p>
                </div>
                <h3>Encounter board</h3>
                <h4>Tiling settings</h4>

                <div class="tileChoice">
                    <label>Maximum number of tiles:</label>
                    <input type="number" id="tileCount" value="4" min="1">
                </div>
                <div class="controls">
                    <div class="controlOption">
                        <input type="radio" id="chain" name="tiling" value="chain" onclick="differ('chain')">
                        <label for="chain">Chained</label>
                    </div>
                    <div class="controlOption">
                        <input type="radio" id="arrangeRandom" name="tiling" value="arrangeRandom" onclick="differ('arrangeRandom')">
                        <label for="arrangeRandom">Random</label>
                    </div>
                    <div class="controlOption">
                        <input type="radio" id="mosaik" name="tiling" value="mosaik" onclick="differ('mosaik')">
                        <label for="mosaik">Mosaic</label>
                    </div>
                    <div class="controlOption">
                        <input type="radio" id="planeGrid2x2" name="tiling" value="planeGrid2x2" onclick="differ('planeGrid2x2')">
                        <label for="planeGrid2x2">2x2</label>
                    </div>
                    <div class="controlOption">
                        <input type="radio" id="planeGrid3x3" name="tiling" value="planeGrid3x3" onclick="differ('planeGrid3x3')">
                        <label for="planeGrid3x3">3x3</label>
                    </div>
                </div>
                <p class="explanation">You must select at least two boxes to generate a 3x3 board, otherwise errors may occur.</p>
                <div class="generationButtons">
                    <button onclick="generateGrid()">Generate board</button>
                    <button id="generateTerrain" onclick="generateTerrain()">Generate terrain</button>
                </div>

                <h4>Terrain settings</h4>
                <p id="terrainSquare">Terrain (square symbol):</p>
                <p id="terrainTriangle">Terrain (triangle symbol):</p>
            </div>

            <div class="col2">
                <div id="output" class="grid"></div>
            </div>

        </div>

        <h2>Encounter brief</h2>
        <div class="secondRow">
            <div class="col3">
                <h3>Encounter brief Settings</h3>
                <div class="settings">
                    <h4>Encounter level settings</h4>
                    <div class="setting">
                        <input type="checkbox" id="1-2" name="1-2" value="1-2" onclick="differ('1-2')">
                        <label for="1-2">1-2 players</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="3-4" name="3-4" value="3-4" onclick="differ('3-4')">
                        <label for="3-4">3-4 players</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="dualEnemys" name="dualEnemys" value="dualEnemys">
                        <label for="dualEnemys">Dual enemies</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="lvl4" name="lvl4" value="lvl4">
                        <label for="lvl4"> Enable level 4 encounters (huge machines)</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="lvl5" name="lvl5" value="lvl5">
                        <label for="lvl5"> Enable Level 5 encounters (huge machines with secondary enemies)</label>
                    </div>
                    <h4>Expansions settings</h4>
                    <div class="setting">
                        <input type="checkbox" id="TJ" name="TJ" value="TJ">
                        <label for="TJ">Thunderjaw (Huge machine)</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="SB" name="SB" value="SB">
                        <label for="SB">Stormbird (Huge machine)</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="FC" name="FC" value="FC">
                        <label for="FC">Fireclaw (Huge machine)</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="RB" name="RB" value="RB">
                        <label for="RB">Rockbreaker (Huge machine)</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="HN" name="HN" value="HN">
                        <label for="HN">Heart of the Nora (huge machine and normal enemy)</label>
                    </div>
                    <div class="setting">
                        <input type="checkbox" id="LB" name="LB" value="LB">
                        <label for="LB">The Lawless Badlands (bandits)</label>
                    </div>

                </div>
                <div class="generationButtons">
                    <button onclick="generateEncounterBriefV6()">Generate encounter brief</button>
                </div>
            </div>
            <div class="col4">
                <h3>Encounter recap</h3>
                <p id="encounterLevel">Encounter Level:</p>
                <p id="encounterResources">Encounter Resources:</p>
                <h4>Machine list</h4>

                <div id="encounterBrief">
                    <table id="machineList">
                        <tr><th>Primary Enemy (A)</th><th>Count</th><th>Secondary Enemy (B)</th><th>Count</th></tr>
                    </table>
                    <div id="difficultyBarContainer"></div>
                </div>

                <p class="explanation">Warning: the level of the generated encounter is not exactly matching those of the original encounters. Additionally, an encounter board must have been generated before generating an encounter brief.</p>

            </div>
        </div>

        <div class="exportRow">
            <h2>Export encounter</h2>
            <!-- <img src="system/resources/title2.png" style="height: 40px;"> -->
            <div class="setting">
                <input type="checkbox" id="includeNumbers" name="includeNumbers" value="1">
                <label for="includeNumbers">Generate card with numbers</label>
            </div>
            <!-- <div class="dropbtn" onclick="toggleDropdown(this)"></div>
            <div class="dropdown-content">
                <a onclick=>open as Encounter Card</a>
                <a onclick=>copy Encounter Card link to clipboard</a>
            </div> -->
            <div class="generationButtons">
                <button onclick="generateEncounterCard(document.getElementById('includeNumbers').checked)">Open as Encounter Card</button>
                <button onclick="copyLink(document.getElementById('includeNumbers').checked)">Copy Encounter Card link to clipboard</button>
            </div>
        </div>

    </main>

    <footer>
        <p></p>
    </footer>
</body>

</html>
